
# Intro to log Analysis

**Difficulty:** Easy
# Table of Contents
o	Room summary

o	Objectives

o	Task walkthrough
1.	Task 1: Introduction
2.	Task 2: Logs and their typed
3.	Task 3: Investigation
4.	Task 4: Log File Location
5.	Task 5: Automated and Manual analysis
6.	Task 6: Log Analysis Tools
7.	Task 7: Using Regular Expressions for Log Analysis and Parsing
8.	Task 8: Log Analysis tool – Cyber chef
9.	Task 9: Yara and Sigma




# Room summary

This room explores critical role of log files in cyber security. It  helps user to understand common log formats, understanding essential fields and applying detection technique to identify malicious behavior using real world examples.

## Objectives

•Understand types of logs (auth, Apache, syslog, etc.)

•Learn structure and fields in logs

•Identify indicators of compromise (IoCs)

•Practice basic log analysis using command-line tools

### Task 1: Introduction
Log analysis is the process of examining computer-generated records (logs) to detect unauthorized access, misuse, or unusual activity. These logs are critical for Security Operations Centers (SOC) and incident response teams.

**Q: What is the main goal of log analysis?**

**A:** To detect suspicious or malicious behavior from system or network activity.

### Task 2: Log File Types

•	Application Logs: Messages from specific applications, providing insights into their status, errors, warnings, and other operational details.

•	Audit Logs: Events, actions, and changes occurring within a system or application, providing a history of user activities and system behavior.

•	Security Logs: Security-related events like logins, permission alterations, firewall activities, and other actions impacting system security.

•	Server Logs: System logs, event logs, error logs, and access logs, each offering distinct information about server operations.

•	System Logs: Kernel activities, system errors, boot sequences, and hardware status, aiding in diagnosing system issues.

•	Network Logs: Communication and activity within a network, capturing information about events, connections, and data transfers.

•	Database Logs: Activities within a database system, such as queries performed, actions, and updates.

•	Web Server Logs: Requests processed by web servers, including URLs, source IP addresses, request types, response codes, and more.

### Task 3: Investigation

**Q: What is Investigation?**
**A:**  refers to the process of examining log data to identify, understand, and respond to security events or operational issues. It is a key task for SOC analysts, threat hunters, and incident responders.

### Timeline

A timeline in log analysis is a chronological sequence of events such as logins, file modifications, network requests, and system actions reconstructed from log data.It allows analysts to trace activities in the exact order they occurred, much like watching a movie unfold scene by scene. This structured view is essential for understanding attacker behavior, identifying anomalies, and conducting effective incident response.

### Timestamp

A timestamp in log analysis is the precise date and time associated with a specific event recorded in a log entry. 

***Example***
2025-06-15T14:32:21Z (ISO 8601 format)

Jun 15 14:32:21 (syslog format)

15/06/2025 02:32:21 PM


### Super Timelines

A super timeline is a consolidated, time-ordered list of events created by merging logs and artifacts from various sources and systems (e.g., OS logs, browser history, file metadata, registry entries). It offers an in-depth, high-resolution perspective of all system and user activity in a given time span, supporting extensive forensic analysis and incident response.

### Data Visualization

Log analysis data visualization is the graphical interpretation of data derived from logs—alerts, events, patterns, or anomalies—to improve understanding, accelerate threat identification, and aid decision-making within a SOC context. Transforming difficult log data into visual representations such as graphs, charts, or timelines allows analysts to rapidly detect trends, outliers, and malicious activities.

***And you can learn about everything else from TryHackMe rooms, so let's not waste our time discussing that here..***

### Task 4: Log File Location

***Common Log File Locations***

A crucial aspect of log analysis is understanding where to locate log files generated by various applications and systems. While log file paths can vary due to system configurations, 
software versions, and custom settings, knowing common log file locations is essential for efficient investigation and threat detection.


•	Web Servers:

•	Nginx:

•	Access Logs: /var/log/nginx/access.log

•	Error Logs: /var/log/nginx/error.log

•	Apache:

•	Access Logs: /var/log/apache2/access.log

•	Error Logs: /var/log/apache2/error.log


•	Databases:

•	MySQL:

•	Error Logs: /var/log/mysql/error.log

•	PostgreSQL:

•	Error and Activity Logs: /var/log/postgresql/postgresql-{version}-main.log


•	Web Applications:

•	PHP:
•	Error Logs: /var/log/php/error.log


•	Operating Systems:

•	Linux:

•	General System Logs: /var/log/syslog

•	Authentication Logs: /var/log/auth.log


•	Firewalls and IDS/IPS:

•	iptables:

•	Firewall Logs: /var/log/iptables.log

•	Snort:

•	Snort Logs: /var/log/snort/

### Task 5: Automated and Manual Analysis

Automated Analysis
Automated analysis involves the use of tools. For example, these often include commercial tools such as XPLG or SolarWinds Loggly. Automated analysis tools allow for processing and data analysis of logs. These tools often utilize Artificial Intelligence / Machine Learning to analyze patterns and trends. As the AI landscape evolves, we expect to see more effective automated analysis solutions.

Manual Analysis
Manual analysis is the process of examining data and artifacts without using automation tools. For example, an analyst scrolling through a web server log would be considered manual analysis. Manual analysis is essential for an analyst because automation tools cannot be relied upon.

### Task 6: Log analysis tools

***Basic file viewing tool***


1. cat – Concatenate and Display Files
Prints the entire contents of a file.

Useful for small logs; not ideal for large files due to lack of navigation.

```bash
  cat apache.log
```
2. less – Paginated Log Viewing
Displays files page by page.

Allows navigation using arrow keys, PgUp, PgDn, / for search.
 ```bash
 less apache.log
 ```

3. tail – View the End of a File
Shows the last few lines (default: 10).

Use -f to monitor logs in real-time (live updates).

Use -n to customize the number of lines.
```bash
tail -f -n 5 apache.log
```

4. wc – Word/Line/Character Count
Quickly gives a sense of file size and content volume.

```bash
wc apache.log
```
 ***Data Extraction & Field Manipulation***

 5. cut – Extract Specific Fields
Ideal for structured logs (e.g., space or tab delimited).

Example: Extract IP addresses (field 1), URLs (field 7), or status codes (field 9).

```bash
cut -d ' ' -f 1 apache.log
```

6. sort – Arrange Log Data
Sorts output alphabetically or numerically.

Use with cut or other commands for preprocessing.

```bash
cut -d ' ' -f 1 apache.log | sort -n
```

7. uniq – Remove Duplicate Lines
Often paired with sort to clean up data.

Add -c to count occurrences of each unique line.
```bash
cut -d ' ' -f 1 apache.log | sort -n | uniq -c
```
***Text Manipulation Tools***

8. sed – Stream Editor
Replaces or transforms text using patterns.

Example: Replace date format in logs.
```bash
sed 's/31\/Jul\/2023/July 31, 2023/g' apache.log
```

9. awk – Pattern Matching and Field Processing
Perfect for conditional filtering.

Example: Print all entries with HTTP status codes ≥ 400.
```bash
awk '$9 >= 400' apache.log
```

10. grep – Pattern Search
Locates specific strings or regex patterns.

Powerful for keyword-based filtering, counting, or excluding entries.

```bash
grep "admin" apache.log                # Find "admin" in log
grep -c "admin" apache.log             # Count matches
grep -n "admin" apache.log             # Show line numbers
grep -v "/index.php" apache.log        # Exclude lines with "/index.php"

```
